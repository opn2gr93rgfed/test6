# Smart Dynamic One Time Provider - Одноразовые профили с автоудалением

## 🔥 Описание

**Smart Dynamic One Time** - это провайдер для генерации скриптов автоматизации Octobrowser с **автоматическим удалением профилей** после завершения работы.

### Отличия от Smart Dynamic

| Характеристика | Smart Dynamic | **Smart Dynamic One Time** |
|---------------|---------------|---------------------------|
| Скорость поиска ответов | ⚡ O(1) моментальный поиск | ⚡ O(1) моментальный поиск |
| Динамический порядок вопросов | ✅ Да | ✅ Да |
| Многопоточность | ✅ Да | ✅ Да |
| Прокси (статик + ротация) | ✅ Да | ✅ Да |
| 9Proxy интеграция | ✅ Да | ✅ Да |
| Fingerprints, теги, геолокация | ✅ Да | ✅ Да |
| **Профили после завершения** | ⚠️ Остаются в аккаунте | 🔥 **Автоматически удаляются** |

## 🎯 Когда использовать?

### ✅ Используйте Smart Dynamic One Time:
- Массовые задачи (100+ итераций)
- Регистрации, где профиль нужен один раз
- Парсинг/скрейпинг, где не нужны cookies/история
- Тестирование скриптов
- Когда нужно экономить место в Octobrowser

### ⚠️ НЕ используйте One Time:
- Когда нужно сохранить cookies/session
- Работа с аккаунтами, которые используются повторно
- Прогрев профилей
- Долгосрочные кампании

## 🚀 Как это работает?

### 1. Создание профиля
```python
profile_uuid = create_profile(profile_title, proxy_dict)
```

### 2. Запуск и работа
```python
start_data = start_profile(profile_uuid)
# ... выполнение автоматизации ...
```

### 3. Остановка профиля
```python
stop_profile(profile_uuid)
```

### 4. 🔥 **Автоудаление** (НОВОЕ!)
```python
finally:
    if profile_uuid:
        time.sleep(1)
        # Удаляем профиль через API
        print(f"[CLEANUP] Удаление одноразового профиля...")
        delete_profile(profile_uuid)
```

## 📊 Workflow

```
┌─────────────────────────────────────────────┐
│ 1. Загрузка CSV данных                      │
└──────────────────┬──────────────────────────┘
                   │
┌──────────────────▼──────────────────────────┐
│ 2. Создание профиля через API               │
│    - Fingerprint                            │
│    - Proxy (статик/ротация/9Proxy)          │
│    - Теги                                   │
│    - Геолокация                             │
└──────────────────┬──────────────────────────┘
                   │
┌──────────────────▼──────────────────────────┐
│ 3. Запуск профиля (Octobrowser Local API)   │
└──────────────────┬──────────────────────────┘
                   │
┌──────────────────▼──────────────────────────┐
│ 4. Подключение Playwright (CDP)             │
└──────────────────┬──────────────────────────┘
                   │
┌──────────────────▼──────────────────────────┐
│ 5. Выполнение автоматизации                 │
│    - Динамичный поиск вопросов O(1)         │
│    - Заполнение форм                        │
│    - Клики, скроллы, навигация              │
└──────────────────┬──────────────────────────┘
                   │
┌──────────────────▼──────────────────────────┐
│ 6. Закрытие браузера                        │
└──────────────────┬──────────────────────────┘
                   │
┌──────────────────▼──────────────────────────┐
│ 7. Остановка профиля                        │
└──────────────────┬──────────────────────────┘
                   │
┌──────────────────▼──────────────────────────┐
│ 8. 🔥 УДАЛЕНИЕ ПРОФИЛЯ через API            │
│    DELETE /profiles/{uuid}                  │
└─────────────────────────────────────────────┘
```

## ⚙️ Настройки

Все настройки идентичны **Smart Dynamic**:

### Прокси
- ✅ Статичные прокси (один прокси на весь скрипт)
- ✅ Ротация прокси (из списка CSV)
- ✅ 9Proxy интеграция (API ротация в реальном времени)

### Многопоточность
- Одновременно до 10+ потоков
- Автоматическая задержка старта (3s между потоками)
- Независимая работа каждого потока

### Fingerprints
- Автоматическая генерация
- Кастомные настройки (OS, браузер, screen)
- Геолокация, WebRTC, Canvas, WebGL

### Теги
- Добавление тегов к профилям
- Организация профилей (хотя они удаляются сразу!)

## 🔧 Технические детали

### Функция удаления профиля

```python
def delete_profile(profile_uuid: str):
    """Удалить профиль"""
    url = f"{API_BASE_URL}/profiles/{profile_uuid}"
    headers = {"X-Octo-Api-Token": API_TOKEN}
    try:
        requests.delete(url, headers=headers, timeout=10)
        print(f"[PROFILE] [OK] Профиль удалён")
    except:
        pass
```

### Где вызывается?

В функции `process_task()` в блоке `finally`:

```python
try:
    # ... создание профиля, запуск, автоматизация ...
except Exception as e:
    # ... обработка ошибок ...
finally:
    if profile_uuid:
        time.sleep(1)
        # 🔥 ONE TIME PROFILE: Удаляем профиль
        delete_profile(profile_uuid)
```

Это гарантирует удаление профиля **даже при ошибках!**

## 📈 Преимущества

### 1. 🧹 Чистота аккаунта
- Нет мусорных профилей
- Не засоряется интерфейс Octobrowser
- Легко отслеживать активные профили

### 2. 💰 Экономия места
- Не храним ненужные данные
- Освобождаем место для новых профилей
- Оптимальное использование ресурсов

### 3. 🔒 Безопасность
- Удаляются все данные профиля
- Не остаются следы в системе
- Минимальный риск утечки данных

### 4. ⚡ Производительность
- Меньше профилей = быстрее синхронизация
- Octobrowser работает эффективнее
- Нет лишней нагрузки на систему

## 🎬 Пример использования

### Сценарий: Массовая регистрация 500 аккаунтов

**Без One Time:**
- После выполнения: 500 профилей в Octobrowser
- Нужно вручную удалять
- Занимает много места
- Сложно найти нужные профили

**С One Time:**
- После выполнения: 0 профилей!
- Автоматическая очистка
- Чистый аккаунт
- Готов к следующей задаче

## 🔄 Миграция со Smart Dynamic

Просто выберите **smart_dynamic_onetime** в GUI!

Вся функциональность сохраняется:
- ✅ Динамичный поиск вопросов
- ✅ Многопоточность
- ✅ Прокси ротация
- ✅ 9Proxy
- ✅ Fingerprints
- ✅ CSV данные
- ✅ Специальные команды (#pause, #scroll_search, и т.д.)

**Единственное отличие:** профили удаляются автоматически!

## ⚠️ Важные замечания

### 1. Cookies и Session НЕ сохраняются
После удаления профиля все данные теряются:
- Cookies
- LocalStorage
- SessionStorage
- История браузера
- Закладки

### 2. Нельзя переиспользовать профиль
Профиль существует только во время выполнения скрипта.

### 3. Прокси работают как обычно
Даже после удаления профиля, прокси остаются в вашем списке Octobrowser (если вы их добавляли через API).

### 4. Удаление асинхронное
API удаление может занять несколько секунд. Профиль может оставаться в интерфейсе Octobrowser еще некоторое время.

## 🐛 Устранение неполадок

### Профиль не удаляется
1. Проверьте API токен
2. Убедитесь, что профиль был создан
3. Проверьте логи на ошибки API

### Ошибка "Profile not found"
- Это нормально, если профиль уже был удален
- Функция `delete_profile()` игнорирует ошибки

## 📚 Дополнительно

### API документация Octobrowser
- Swagger: https://swagger.octobrowser.net/
- Postman: https://documenter.getpostman.com/view/1801428/UVC6i6eA

### Endpoints
- `POST /profiles` - Создание профиля
- `DELETE /profiles/{uuid}` - Удаление профиля

## 🎉 Заключение

**Smart Dynamic One Time** - идеальное решение для массовых задач, где не нужно сохранять профили. Вся мощь **Smart Dynamic** + автоматическая очистка!

---

**Автор:** auto2tesst Team
**Версия:** 3.0 EPIC EDITION
**Дата создания:** 2025-11-25
